-- ----------------------------
--  Change database
-- ----------------------------
USE `zo_wms`;

-- ----------------------------
--  Create views
-- ----------------------------

-- View structure for erp_im_item
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `erp_im_item` AS select `t`.`id` AS `id`,`t`.`create_name` AS `create_name`,`t`.`create_by` AS `create_by`,`t`.`create_date` AS `create_date`,`t`.`update_name` AS `update_name`,`t`.`update_by` AS `update_by`,`t`.`update_date` AS `update_date`,`t`.`sys_org_code` AS `sys_org_code`,`t`.`sys_company_code` AS `sys_company_code`,`t`.`goods_id` AS `goods_id`,`t`.`goods_qua` AS `goods_qua`,`t`.`order_type_code` AS `order_type_code`,`t`.`order_id` AS `order_id`,`t`.`order_id_i` AS `order_id_i`,`t`.`wm_to_up_id` AS `wm_to_up_id`,`t`.`goods_unit` AS `goods_unit`,`t`.`goods_batch` AS `goods_batch`,`t`.`goods_pro_data` AS `goods_pro_data`,`t`.`act_type_code` AS `act_type_code`,`t`.`ku_wei_bian_ma` AS `ku_wei_bian_ma`,`t`.`bin_id` AS `bin_id`,`t`.`cus_code` AS `cus_code`,`t`.`base_unit` AS `base_unit`,`t`.`base_goodscount` AS `base_goodscount`,`t`.`goods_name` AS `goods_name`,`t`.`id` AS `wms_id`,(select `wm_im_notice_i`.`other_id` from `wm_im_notice_i` where (`wm_im_notice_i`.`id` = (select `wm_in_qm_i`.`im_notice_item` from `wm_in_qm_i` where (`wm_in_qm_i`.`id` = `t`.`wm_to_up_id`)))) AS `erp_id`,(select `wm_im_notice_i`.`im_cus_code` from `wm_im_notice_i` where (`wm_im_notice_i`.`id` = (select `wm_in_qm_i`.`im_notice_item` from `wm_in_qm_i` where (`wm_in_qm_i`.`id` = `t`.`wm_to_up_id`)))) AS `im_cus_code` from `wm_to_up_goods` `t`;

-- View structure for erp_om_item
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `erp_om_item` AS select `t`.`id` AS `id`,`t`.`create_name` AS `create_name`,`t`.`create_by` AS `create_by`,`t`.`create_date` AS `create_date`,`t`.`update_name` AS `update_name`,`t`.`update_by` AS `update_by`,`t`.`update_date` AS `update_date`,`t`.`sys_org_code` AS `sys_org_code`,`t`.`sys_company_code` AS `sys_company_code`,`t`.`goods_id` AS `goods_id`,`t`.`goods_qua` AS `goods_qua`,`t`.`goods_quaok` AS `goods_quaok`,`t`.`order_id` AS `order_id`,`t`.`order_id_i` AS `order_id_i`,`t`.`order_type` AS `order_type`,`t`.`goods_unit` AS `goods_unit`,`t`.`goods_pro_data` AS `goods_pro_data`,`t`.`goods_batch` AS `goods_batch`,`t`.`act_type_code` AS `act_type_code`,`t`.`ku_wei_bian_ma` AS `ku_wei_bian_ma`,`t`.`bin_id_to` AS `bin_id_to`,`t`.`bin_id_from` AS `bin_id_from`,`t`.`cus_code` AS `cus_code`,`t`.`down_sta` AS `down_sta`,`t`.`base_unit` AS `base_unit`,`t`.`base_goodscount` AS `base_goodscount`,`t`.`goods_name` AS `goods_name`,`t`.`im_cus_code` AS `im_cus_code`,`t`.`om_bei_zhu` AS `om_bei_zhu`,`t`.`id` AS `wms_id`,(select `wm_om_notice_i`.`other_id` from `wm_om_notice_i` where (`wm_om_notice_i`.`id` = (select `wm_om_qm_i`.`iom_notice_item` from `wm_om_qm_i` where (`wm_om_qm_i`.`id` = `t`.`order_id_i`)))) AS `erp_id` from `wm_to_down_goods` `t`;

-- View structure for mv_cus
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `mv_cus` AS select `mc`.`id` AS `id`,`mc`.`ke_hu_bian_ma` AS `cus_code`,concat(`mc`.`ke_hu_bian_ma`,'-',`mc`.`zhong_wen_qch`) AS `cus_name` from `md_cus` `mc` order by `mc`.`ke_hu_bian_ma`;

-- View structure for mv_cus_cost
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `mv_cus_cost` AS select `mc`.`id` AS `id`,`mc`.`ke_hu_bian_ma` AS `cus_code`,`mc`.`zhong_wen_qch` AS `cus_name`,(select `wc`.`cost_data` from `wm_day_cost` `wc` where (`wc`.`cus_code` = `mc`.`ke_hu_bian_ma`) limit 1) AS `cost_data` from `md_cus` `mc`;

-- View structure for mv_cus_other
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `mv_cus_other` AS select `mc`.`id` AS `id`,`mc`.`suo_shu_ke_hu` AS `suo_shu_ke_hu`,`mc`.`ke_hu_bian_ma` AS `cus_code`,concat(`mc`.`ke_hu_bian_ma`,'-',`mc`.`zhong_wen_qch`) AS `cus_name` from `md_cus_other` `mc` order by `mc`.`ke_hu_bian_ma`;

-- View structure for mv_goods
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `mv_goods` AS select `mg`.`id` AS `id`,`mg`.`suo_shu_ke_hu` AS `cus_code`,`mg`.`shp_bian_ma` AS `goods_id`,`mg`.`shp_bian_ma` AS `goods_code`,concat(`mg`.`shp_bian_ma`,'-',`mg`.`shp_ming_cheng`,'-',`mg`.`shl_dan_wei`) AS `goods_name`,`mg`.`shp_ming_cheng` AS `shp_ming_cheng`,`mg`.`jf_shp_lei` AS `jf_shp_lei`,`mg`.`shl_dan_wei` AS `shl_dan_wei`,`mg`.`cf_wen_ceng` AS `cf_wen_ceng`,`mg`.`mp_dan_ceng` AS `mp_dan_ceng`,`mg`.`mp_ceng_gao` AS `mp_ceng_gao`,`mg`.`shp_tiao_ma` AS `shp_tiao_ma`,`mg`.`bzhi_qi` AS `bzhi_qi`,`mg`.`zhl_kgm` AS `zhl_kgm`,`mg`.`chl_shl` AS `chl_shl`,`mg`.`ti_ji_cm` AS `ti_ji_cm`,`mg`.`zhl_kg` AS `zhl_kg`,`mg`.`zhl_kg` AS `zhl_kg_zx`,`mg`.`chp_shu_xing` AS `chp_shu_xing`,`mg`.`jsh_dan_wei` AS `baseunit`,`mg`.`JIZHUN_WENDU` AS `jizhun_wendu`,`mg`.`SHP_BIAN_MAKH` AS `shp_bian_makh`,'N' AS `chailing`,`mg`.`shl_dan_wei` AS `zhx_unit`,`mg`.`shp_gui_ge` AS `shp_gui_ge`,`mg`.`shp_pin_pai` AS `SHP_PIN_PAI`,`mg`.`gao_zh_xiang` AS `GAO_ZH_XIANG`,`mg`.`ku_zh_xiang` AS `KU_ZH_XIANG`,`mg`.`ch_zh_xiang` AS `CH_ZH_XIANG`,`mg`.`gao_dan_pin` AS `gao_dan_pin`,`mg`.`sku` AS `sku` from `md_goods` `mg` union all select concat(`mg`.`id`,'l') AS `id`,`mg`.`suo_shu_ke_hu` AS `cus_code`,`mg`.`shp_bian_ma` AS `goods_id`,concat(`mg`.`shp_bian_ma`,'l') AS `goods_code`,concat(`mg`.`shp_bian_ma`,'l-',`mg`.`shp_ming_cheng`,'-',`mg`.`jsh_dan_wei`) AS `goods_name`,`mg`.`shp_ming_cheng` AS `shp_ming_cheng`,`mg`.`jf_shp_lei` AS `jf_shp_lei`,`mg`.`jsh_dan_wei` AS `shl_dan_wei`,`mg`.`cf_wen_ceng` AS `cf_wen_ceng`,`mg`.`mp_dan_ceng` AS `mp_dan_ceng`,`mg`.`mp_ceng_gao` AS `mp_ceng_gao`,`mg`.`shp_tiao_ma` AS `shp_tiao_ma`,`mg`.`bzhi_qi` AS `bzhi_qi`,`mg`.`zhl_kgm` AS `zhl_kgm`,`mg`.`chl_shl` AS `chl_shl`,cast((`mg`.`ti_ji_cm` / `mg`.`chl_shl`) as signed) AS `ti_ji_cm`,(`mg`.`zhl_kg` / `mg`.`chl_shl`) AS `zhl_kg`,`mg`.`zhl_kg` AS `zhl_kg_zx`,`mg`.`chp_shu_xing` AS `chp_shu_xing`,`mg`.`jsh_dan_wei` AS `baseunit`,`mg`.`JIZHUN_WENDU` AS `jizhun_wendu`,`mg`.`SHP_BIAN_MAKH` AS `shp_bian_makh`,'Y' AS `chailing`,`mg`.`shl_dan_wei` AS `zhx_unit`,`mg`.`shp_gui_ge` AS `shp_gui_ge`,`mg`.`shp_pin_pai` AS `SHP_PIN_PAI`,`mg`.`gao_zh_xiang` AS `GAO_ZH_XIANG`,`mg`.`ku_zh_xiang` AS `KU_ZH_XIANG`,`mg`.`ch_zh_xiang` AS `CH_ZH_XIANG`,`mg`.`gao_dan_pin` AS `gao_dan_pin`,`mg`.`sku` AS `sku` from `md_goods` `mg` where (`mg`.`chl_kong_zhi` = 'Y');

-- View structure for mv_down_and_up
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `mv_down_and_up` AS select 'H' AS `leixing`,`wm_to_down_goods`.`id` AS `id`,`wm_to_down_goods`.`create_name` AS `create_name`,`wm_to_down_goods`.`create_by` AS `create_by`,`wm_to_down_goods`.`create_date` AS `create_date`,`wm_to_down_goods`.`order_id` AS `order_id`,`wm_to_down_goods`.`order_id_i` AS `order_id_i`,`wm_to_down_goods`.`goods_unit` AS `goods_unit`,`wm_to_down_goods`.`goods_pro_data` AS `goods_pro_data`,`wm_to_down_goods`.`goods_batch` AS `goods_batch`,`wm_to_down_goods`.`ku_wei_bian_ma` AS `ku_wei_bian_ma`,`wm_to_down_goods`.`bin_id_from` AS `bin_id`,`wm_to_down_goods`.`cus_code` AS `cus_code`,`wm_to_down_goods`.`base_unit` AS `base_unit`,(0 - `wm_to_down_goods`.`base_goodscount`) AS `base_goodscount`,(select `md_goods`.`goods_id` from `mv_goods` `md_goods` where (`md_goods`.`goods_code` = `wm_to_down_goods`.`goods_id`)) AS `goods_id`,(select `md_goods`.`zhl_kg` from `mv_goods` `md_goods` where (`md_goods`.`goods_code` = `wm_to_down_goods`.`goods_id`)) AS `zhl_kg`,(select `md_goods`.`chl_shl` from `mv_goods` `md_goods` where (`md_goods`.`goods_code` = `wm_to_down_goods`.`goods_id`)) AS `chl_shl`,(select `md_goods`.`jf_shp_lei` from `mv_goods` `md_goods` where (`md_goods`.`goods_code` = `wm_to_down_goods`.`goods_id`)) AS `jf_shp_lei` from `wm_to_down_goods` union all select 'S' AS `leixing`,`wm_to_up_goods`.`id` AS `id`,`wm_to_up_goods`.`create_name` AS `create_name`,`wm_to_up_goods`.`create_by` AS `create_by`,`wm_to_up_goods`.`create_date` AS `create_date`,`wm_to_up_goods`.`order_id` AS `order_id`,`wm_to_up_goods`.`order_id_i` AS `order_id_i`,`wm_to_up_goods`.`goods_unit` AS `goods_unit`,`wm_to_up_goods`.`goods_pro_data` AS `goods_pro_data`,`wm_to_up_goods`.`goods_batch` AS `goods_batch`,`wm_to_up_goods`.`ku_wei_bian_ma` AS `ku_wei_bian_ma`,`wm_to_up_goods`.`bin_id` AS `bin_id`,`wm_to_up_goods`.`cus_code` AS `cus_code`,`wm_to_up_goods`.`base_unit` AS `base_unit`,`wm_to_up_goods`.`base_goodscount` AS `base_goodscount`,(select `md_goods`.`goods_id` from `mv_goods` `md_goods` where (`md_goods`.`goods_code` = `wm_to_up_goods`.`goods_id`)) AS `goods_id`,(select `md_goods`.`zhl_kg` from `mv_goods` `md_goods` where (`md_goods`.`goods_code` = `wm_to_up_goods`.`goods_id`)) AS `zhl_kg`,(select `md_goods`.`chl_shl` from `mv_goods` `md_goods` where (`md_goods`.`goods_code` = `wm_to_up_goods`.`goods_id`)) AS `chl_shl`,(select `md_goods`.`jf_shp_lei` from `mv_goods` `md_goods` where (`md_goods`.`goods_code` = `wm_to_up_goods`.`goods_id`)) AS `jf_shp_lei` from `wm_to_up_goods`;

-- View structure for wv_today_stock_move
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `wv_today_stock_move` AS select `wg`.`create_date` AS `create_date`,`wg`.`create_name` AS `create_name`,`wg`.`create_by` AS `create_by`,`wg`.`id` AS `id`,'库存' AS `kuctype`,`wg`.`ku_wei_bian_ma` AS `ku_wei_bian_ma`,trim(`wg`.`bin_id`) AS `bin_id`,`wg`.`cus_code` AS `cus_code`,`wg`.`cus_code` AS `zhong_wen_qch`,`wg`.`goods_id` AS `goods_id`,`wg`.`goods_qua` AS `goods_qua`,`wg`.`order_id` AS `order_id`,`wg`.`goods_pro_data` AS `goods_pro_data`,`wg`.`goods_unit` AS `goods_unit`,`wg`.`base_unit` AS `base_unit`,`wg`.`base_goodscount` AS `base_goodscount` from `wm_to_up_goods` `wg` where (to_days(`wg`.`create_date`) = to_days(now())) union all select `wg`.`create_date` AS `create_date`,`wg`.`create_name` AS `create_name`,`wg`.`create_by` AS `create_by`,`wg`.`id` AS `id`,'库存' AS `kuctype`,`wg`.`ku_wei_bian_ma` AS `ku_wei_bian_ma`,trim(`wg`.`bin_id_from`) AS `bin_id`,`wg`.`cus_code` AS `cus_code`,`wg`.`cus_code` AS `zhong_wen_qch`,`wg`.`goods_id` AS `goods_id`,(0 - `wg`.`goods_quaok`) AS `goods_qua`,`wg`.`order_id` AS `order_id`,`wg`.`goods_pro_data` AS `goods_pro_data`,`wg`.`goods_unit` AS `goods_unit`,`wg`.`base_unit` AS `base_unit`,(0 - `wg`.`base_goodscount`) AS `base_goodscount` from `wm_to_down_goods` `wg` where (to_days(`wg`.`create_date`) = to_days(now())) union all select `wg`.`create_date` AS `create_date`,`wg`.`create_name` AS `create_name`,`wg`.`create_by` AS `create_by`,`wg`.`id` AS `id`,'待下架' AS `kuctype`,`wg`.`bin_id` AS `ku_wei_bian_ma`,trim(`wg`.`tin_id`) AS `bin_id`,`wg`.`cus_code` AS `cus_code`,`wg`.`cus_code` AS `zhong_wen_qch`,`wg`.`goods_id` AS `goods_id`,(0 - `wg`.`qm_ok_quat`) AS `goods_qua`,`wg`.`om_notice_id` AS `order_id`,`wg`.`pro_data` AS `goods_pro_data`,`wg`.`goods_unit` AS `goods_unit`,`wg`.`base_unit` AS `base_unit`,(0 - `wg`.`base_goodscount`) AS `base_goodscount` from `wm_om_qm_i` `wg` where ((`wg`.`bin_sta` = 'N') or (`wg`.`bin_sta` = 'I')) union all select `wq`.`create_date` AS `create_date`,`wq`.`create_name` AS `create_name`,`wq`.`create_by` AS `create_by`,`wq`.`id` AS `id`,'待上架' AS `kuctype`,`wq`.`bin_id` AS `ku_wei_bian_ma`,trim(`wq`.`tin_id`) AS `bin_id`,`wq`.`cus_code` AS `cus_code`,`wq`.`cus_code` AS `zhong_wen_qch`,`wq`.`goods_id` AS `goods_id`,`wq`.`qm_ok_quat` AS `goods_qua`,`wq`.`im_notice_id` AS `order_id`,`wq`.`pro_data` AS `goods_pro_data`,`wq`.`goods_unit` AS `goods_unit`,`wq`.`base_unit` AS `base_unit`,`wq`.`base_goodscount` AS `base_goodscount` from `wm_in_qm_i` `wq` where (((`wq`.`bin_sta` = 'N') or (`wq`.`bin_sta` = 'I')) and (`wq`.`bin_id` <> ' ') and (`wq`.`bin_id` is not null)) union all select `wm_his_stock_data`.`his_date` AS `create_date`,'system' AS `create_name`,'system' AS `create_by`,`wm_his_stock_data`.`id` AS `id`,'库存' AS `kuctype`,`wm_his_stock_data`.`ku_wei_bian_ma` AS `ku_wei_bian_ma`,`wm_his_stock_data`.`bin_id` AS `bin_id`,`wm_his_stock_data`.`cus_code` AS `cus_code`,`wm_his_stock_data`.`cus_name` AS `zhong_wen_qch`,`wm_his_stock_data`.`goods_id` AS `goods_id`,`wm_his_stock_data`.`count` AS `goods_qua`,'kucun' AS `order_id`,`wm_his_stock_data`.`pro_data` AS `goods_pro_data`,`wm_his_stock_data`.`base_unit` AS `goods_unit`,`wm_his_stock_data`.`base_unit` AS `base_unit`,`wm_his_stock_data`.`count` AS `base_goodscount` from `wm_his_stock_data`;

-- View structure for wv_stock_base
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `wv_stock_base` AS select `wg`.`create_date` AS `create_date`,`wg`.`create_name` AS `create_name`,`wg`.`create_by` AS `create_by`,`wg`.`id` AS `id`,`wg`.`kuctype` AS `kuctype`,`wg`.`ku_wei_bian_ma` AS `ku_wei_bian_ma`,trim(`wg`.`bin_id`) AS `bin_id`,`wg`.`cus_code` AS `cus_code`,`mc`.`zhong_wen_qch` AS `zhong_wen_qch`,`mg`.`goods_id` AS `goods_code`,`wg`.`goods_id` AS `goods_id`,`wg`.`goods_qua` AS `goods_qua`,`mg`.`goods_name` AS `goods_name`,`mg`.`shp_ming_cheng` AS `shp_ming_cheng`,`wg`.`goods_pro_data` AS `goods_pro_data`,`mg`.`bzhi_qi` AS `bzhi_qi`,`mg`.`zhl_kgm` AS `yushoutianshu`,`wg`.`goods_unit` AS `goods_unit`,`wg`.`base_unit` AS `base_unit`,`wg`.`base_goodscount` AS `base_goodscount`,`mg`.`shl_dan_wei` AS `shl_dan_wei`,concat(`mg`.`mp_ceng_gao`,'*',`mg`.`mp_dan_ceng`) AS `hiti`,`mg`.`shp_bian_makh` AS `shp_bian_makh`,`mg`.`chl_shl` AS `chl_shl`,`wg`.`order_id` AS `order_id`,`mg`.`zhl_kg` AS `zhl_kg`,`mg`.`shp_gui_ge` AS `shp_gui_ge`,`mg`.`ti_ji_cm` AS `ti_ji_cm` from ((`wv_today_stock_move` `wg` left join `mv_goods` `mg` on((`wg`.`goods_id` = `mg`.`goods_code`))) left join `md_cus` `mc` on((`wg`.`cus_code` = `mc`.`ke_hu_bian_ma`)));

-- View structure for mv_stock_cus
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `mv_stock_cus` AS select `wg`.`id` AS `id`,`wg`.`kuctype` AS `kuctype`,cast(sum(`wg`.`goods_qua`) as signed) AS `goods_qua`,`wg`.`goods_unit` AS `goods_unit`,cast(sum(`wg`.`base_goodscount`) as signed) AS `base_goodscount`,`wg`.`base_unit` AS `base_unit`,`wg`.`ku_wei_bian_ma` AS `ku_wei_bian_ma`,`wg`.`bin_id` AS `bin_id`,`wg`.`cus_code` AS `cus_code`,`wg`.`zhong_wen_qch` AS `zhong_wen_qch`,`wg`.`goods_pro_data` AS `goods_pro_data`,`wg`.`bzhi_qi` AS `bzhi_qi`,(`wg`.`goods_pro_data` + interval `wg`.`bzhi_qi` day) AS `dqr`,`mb`.`ku_wei_lei_xing` AS `ku_wei_lei_xing`,`mb`.`qu_huo_ci_xu` AS `qu_huo_ci_xu`,`mb`.`shang_jia_ci_xu` AS `shang_jia_ci_xu`,`wg`.`goods_id` AS `goods_id`,`wg`.`shp_ming_cheng` AS `shp_ming_cheng`,`wg`.`shl_dan_wei` AS `shl_dan_wei`,`wg`.`hiti` AS `hiti`,`wg`.`shp_bian_makh` AS `shp_bian_makh`,(cast(sum(`wg`.`base_goodscount`) as signed) * `wg`.`zhl_kg`) AS `zhong_liang` from (`wv_stock_base` `wg` left join `md_bin` `mb` on((`wg`.`ku_wei_bian_ma` = `mb`.`ku_wei_bian_ma`))) group by `wg`.`cus_code`,`wg`.`zhong_wen_qch`,`wg`.`goods_code`,`wg`.`goods_pro_data`,`wg`.`bzhi_qi`,`wg`.`kuctype` having (sum(`wg`.`base_goodscount`) <> 0) order by `wg`.`cus_code`,`wg`.`goods_id`;

-- View structure for mv_stock_yj_base
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `mv_stock_yj_base` AS select `wg`.`id` AS `id`,`wg`.`kuctype` AS `kuctype`,cast(sum(`wg`.`base_goodscount`) as signed) AS `base_goodscount`,`wg`.`base_unit` AS `base_unit`,`wg`.`ku_wei_bian_ma` AS `ku_wei_bian_ma`,`wg`.`bin_id` AS `bin_id`,`wg`.`cus_code` AS `cus_code`,`wg`.`zhong_wen_qch` AS `zhong_wen_qch`,`mg`.`goods_id` AS `goods_id`,`mg`.`shp_ming_cheng` AS `shp_ming_cheng`,`mg`.`shl_dan_wei` AS `shl_dan_wei`,`wg`.`goods_pro_data` AS `goods_pro_data`,`wg`.`bzhi_qi` AS `bzhi_qi`,(`wg`.`goods_pro_data` + interval `wg`.`bzhi_qi` day) AS `dqr`,(`wg`.`bzhi_qi` - (to_days(now()) - to_days(`wg`.`goods_pro_data`))) AS `res_date`,1 AS `qu_huo_ci_xu`,2 AS `shang_jia_ci_xu`,`mg`.`shp_bian_makh` AS `shp_bian_makh` from (`wv_stock_base` `wg` left join `mv_goods` `mg` on((`mg`.`goods_code` = `wg`.`goods_id`))) group by `wg`.`cus_code`,`wg`.`zhong_wen_qch`,`mg`.`goods_id`,`mg`.`shp_ming_cheng`,`wg`.`goods_pro_data`,`wg`.`bzhi_qi`,`wg`.`kuctype` having (sum(`wg`.`base_goodscount`) <> 0) order by `dqr`,`wg`.`cus_code`;

-- View structure for mv_stock_yj
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `mv_stock_yj` AS select `mv_stock_yj_base`.`id` AS `id`,`mv_stock_yj_base`.`kuctype` AS `kuctype`,`mv_stock_yj_base`.`base_goodscount` AS `base_goodscount`,`mv_stock_yj_base`.`base_unit` AS `base_unit`,`mv_stock_yj_base`.`ku_wei_bian_ma` AS `ku_wei_bian_ma`,`mv_stock_yj_base`.`bin_id` AS `bin_id`,`mv_stock_yj_base`.`cus_code` AS `cus_code`,`mv_stock_yj_base`.`zhong_wen_qch` AS `zhong_wen_qch`,`mv_stock_yj_base`.`goods_id` AS `goods_id`,`mv_stock_yj_base`.`shp_ming_cheng` AS `shp_ming_cheng`,`mv_stock_yj_base`.`shl_dan_wei` AS `shl_dan_wei`,`mv_stock_yj_base`.`goods_pro_data` AS `goods_pro_data`,`mv_stock_yj_base`.`bzhi_qi` AS `bzhi_qi`,`mv_stock_yj_base`.`dqr` AS `dqr`,`mv_stock_yj_base`.`res_date` AS `res_date`,`mv_stock_yj_base`.`qu_huo_ci_xu` AS `qu_huo_ci_xu`,`mv_stock_yj_base`.`shang_jia_ci_xu` AS `shang_jia_ci_xu`,`mv_stock_yj_base`.`shp_bian_makh` AS `shp_bian_makh`,cast((`mv_stock_yj_base`.`res_date` / `mv_stock_yj_base`.`bzhi_qi`) as decimal(10,2)) AS `guoqibili` from `mv_stock_yj_base`;

-- View structure for rp_wm_down_and_qm
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `rp_wm_down_and_qm` AS select `t`.`id` AS `id`,`h`.`om_sta` AS `om_sta`,`t`.`om_notice_id` AS `om_notice_id`,`h`.`IM_CUS_CODE` AS `im_cus_code`,`h`.`ocus_code` AS `ocus_code`,`h`.`ocus_name` AS `ocus_name`,`h`.`om_beizhu` AS `om_beizhu`,`h`.`delv_addr` AS `delv_addr`,`t`.`goods_id` AS `goods_id`,`t`.`goods_name` AS `goods_name`,`t`.`base_goodscount` AS `base_goodscount`,`t`.`goods_unit` AS `goods_unit`,`t`.`plan_sta` AS `plan_sta`,(select sum(`om`.`base_goodscount`) from `wm_om_qm_i` `om` where (`om`.`iom_notice_item` = `t`.`id`)) AS `sumqua` from (`wm_om_notice_i` `t` join `wm_om_notice_h` `h`) where ((`t`.`om_notice_id` = `h`.`om_notice_id`) and ((`h`.`om_sta` <> '已删除') or (`h`.`om_sta` is null))) order by `h`.`create_date` desc;

-- View structure for rp_wm_his_stock_ku
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `rp_wm_his_stock_ku` AS select `wh`.`id` AS `id`,`wh`.`his_date` AS `his_date`,`wh`.`cus_code` AS `cus_code`,`mc`.`zhong_wen_qch` AS `zhong_wen_qch`,`wh`.`ku_wei_bian_ma` AS `ku_wei_bian_ma`,`wh`.`bin_id` AS `bin_id`,`wh`.`goods_id` AS `goods_id`,`mg`.`shp_ming_cheng` AS `shp_ming_cheng`,`wh`.`count` AS `count`,`wh`.`base_unit` AS `base_unit`,(`mg`.`zhl_kg` / `mg`.`chl_shl`) AS `zhl_kg`,`mg`.`chl_shl` AS `chl_shl` from ((`wm_his_stock_ku` `wh` join `md_cus` `mc`) join `md_goods` `mg`) where ((`wh`.`cus_code` = `mc`.`ke_hu_bian_ma`) and (`wh`.`goods_id` = `mg`.`shp_bian_ma`));

-- View structure for rp_wm_in_qm
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `rp_wm_in_qm` AS select `wg`.`id` AS `id`,`wg`.`create_date` AS `create_date`,`wg`.`create_name` AS `create_name`,`wg`.`create_by` AS `create_by`,`wg`.`im_notice_id` AS `im_notice_id`,`wg`.`item_text` AS `item_text`,`wg`.`rec_deg` AS `rec_deg`,`wg`.`bin_id` AS `ku_wei_bian_ma`,`wg`.`tin_id` AS `bin_id`,`wg`.`cus_code` AS `cus_code`,`mc`.`zhong_wen_qch` AS `zhong_wen_qch`,`mg`.`goods_id` AS `goods_code`,`wg`.`goods_id` AS `goods_id`,`wg`.`qm_ok_quat` AS `goods_qua`,`mg`.`goods_name` AS `shp_ming_cheng`,`wg`.`pro_data` AS `goods_pro_data`,`mg`.`bzhi_qi` AS `bzhi_qi`,`wg`.`goods_unit` AS `goods_unit`,`wg`.`base_unit` AS `base_unit`,`wg`.`base_goodscount` AS `base_goodscount`,`mg`.`zhl_kg` AS `zhl_kg`,(`wg`.`base_goodscount` * `mg`.`zhl_kg`) AS `sumzhl` from ((`wm_in_qm_i` `wg` join `md_cus` `mc`) join `mv_goods` `mg`) where ((`wg`.`cus_code` = `mc`.`ke_hu_bian_ma`) and (`wg`.`goods_id` = `mg`.`goods_code`)) having (`wg`.`base_goodscount` > 0);

-- View structure for rp_wm_to_down_goods
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `rp_wm_to_down_goods` AS select `wg`.`id` AS `id`,`wg`.`create_date` AS `create_date`,`wg`.`create_name` AS `create_name`,`wg`.`order_id` AS `order_id`,`wg`.`ku_wei_bian_ma` AS `ku_wei_bian_ma`,`wg`.`bin_id_from` AS `bin_id`,`wg`.`bin_id_to` AS `bin_id_to`,`wg`.`cus_code` AS `cus_code`,`mc`.`zhong_wen_qch` AS `zhong_wen_qch`,`mg`.`goods_id` AS `goods_code`,`mg`.`goods_name` AS `shp_ming_cheng`,`wg`.`goods_pro_data` AS `goods_pro_data`,`mg`.`bzhi_qi` AS `bzhi_qi`,`wg`.`base_unit` AS `base_unit`,`wg`.`base_goodscount` AS `base_goodscount`,`mg`.`zhl_kg` AS `zhl_kg`,(select `wm_om_notice_h`.`re_member` from `wm_om_notice_h` where (`wm_om_notice_h`.`om_notice_id` = `wg`.`order_id`)) AS `shouhuoren` from ((`wm_to_down_goods` `wg` join `md_cus` `mc`) join `mv_goods` `mg`) where ((`wg`.`cus_code` = `mc`.`ke_hu_bian_ma`) and (`wg`.`goods_id` = `mg`.`goods_code`)) order by `wg`.`create_date` desc;

-- View structure for rp_wm_to_up_goods
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `rp_wm_to_up_goods` AS select `wg`.`id` AS `id`,`wg`.`create_date` AS `create_date`,`wg`.`create_name` AS `create_name`,`wg`.`create_by` AS `create_by`,`wg`.`order_id` AS `order_id`,`wg`.`ku_wei_bian_ma` AS `ku_wei_bian_ma`,`wg`.`bin_id` AS `bin_id`,`wg`.`cus_code` AS `cus_code`,`mc`.`zhong_wen_qch` AS `zhong_wen_qch`,`mg`.`goods_id` AS `goods_code`,`mg`.`goods_name` AS `shp_ming_cheng`,`wg`.`goods_pro_data` AS `goods_pro_data`,`mg`.`bzhi_qi` AS `bzhi_qi`,`wg`.`base_unit` AS `base_unit`,`wg`.`base_goodscount` AS `base_goodscount`,`mg`.`zhl_kg` AS `zhl_kg` from ((`wm_to_up_goods` `wg` join `md_cus` `mc`) join `mv_goods` `mg`) where ((`wg`.`cus_code` = `mc`.`ke_hu_bian_ma`) and (`wg`.`goods_id` = `mg`.`goods_code`)) order by `wg`.`create_date` desc;

-- View structure for rp_wm_up_and_down
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `rp_wm_up_and_down` AS select `wv`.`id` AS `id`,`wv`.`create_date` AS `create_date`,`wv`.`order_id` AS `order_id`,`wv`.`ku_wei_bian_ma` AS `ku_wei_bian_ma`,`wv`.`bin_id` AS `bin_id`,`wv`.`cus_code` AS `cus_code`,`wv`.`zhong_wen_qch` AS `zhong_wen_qch`,`wv`.`goods_id` AS `goods_id`,`wv`.`shp_ming_cheng` AS `shp_ming_cheng`,`wv`.`goods_pro_data` AS `goods_pro_data`,`wv`.`base_goodscount` AS `base_goodscount`,`wv`.`base_unit` AS `base_unit`,`mb`.`ku_wei_lei_xing` AS `leixing` from (`wv_stock_base` `wv` join `md_bin` `mb`) where ((`wv`.`ku_wei_bian_ma` = `mb`.`ku_wei_bian_ma`) and (`wv`.`kuctype` = '库存'));

-- View structure for tmsv_app_menu
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `tmsv_app_menu` AS select distinct `t_s_base_user`.`username` AS `username`,`tms_app_menu`.`title` AS `title`,`tms_app_menu`.`pagename` AS `pagename`,`tms_app_menu`.`sortno` AS `sortno`,`tms_app_menu`.`icon` AS `icon`,`tms_app_menu`.`iconcolor` AS `iconcolor` from ((((`t_s_base_user` join `t_s_role_user` on((`t_s_base_user`.`ID` = `t_s_role_user`.`userid`))) join `t_s_role_function` on((`t_s_role_user`.`roleid` = `t_s_role_function`.`roleid`))) join `t_s_function` on((`t_s_role_function`.`functionid` = `t_s_function`.`ID`))) join `tms_app_menu` on((`t_s_function`.`functionurl` = `tms_app_menu`.`functionurl`))) order by `t_s_base_user`.`username`,`tms_app_menu`.`sortno`,`tms_app_menu`.`icon`,`tms_app_menu`.`iconcolor`;

-- View structure for tmsv_order_stat
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `tmsv_order_stat` AS select count(`tms_yw_dingdan`.`id`) AS `count`,left(`tms_yw_dingdan`.`create_date`,7) AS `month` from `tms_yw_dingdan` where ((`tms_yw_dingdan`.`zhuangtai` <> '已删除') and (left(`tms_yw_dingdan`.`create_date`,4) = left(sysdate(),4))) group by `month` order by `month`;

-- View structure for v_order_stat
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `v_order_stat` AS select count(`wm_im_notice_h`.`id`) AS `count`,left(`wm_im_notice_h`.`create_date`,7) AS `month` from `wm_im_notice_h` where (left(`wm_im_notice_h`.`create_date`,4) = left(sysdate(),4)) group by `month` order by `month`;

-- View structure for v_tms_dz
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `v_tms_dz` AS select `tms_md_dz`.`id` AS `id`,concat(`tms_md_dz`.`username`,'-',`tms_md_dz`.`lianxiren`,'-',`tms_md_dz`.`dianhua`,'-',`tms_md_dz`.`xiangxidizhi`) AS `dizhi` from `tms_md_dz`;

-- View structure for v_ysdd
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `v_ysdd` AS select `tms_yw_dingdan`.`id` AS `id`,date_format(`tms_yw_dingdan`.`create_date`,'%Y-%m-%d') AS `create_date`,`tms_yw_dingdan`.`fahuoren` AS `fahuoren`,`tms_yw_dingdan`.`huowu` AS `huowu`,`tms_yw_dingdan`.`hwshjs` AS `hwshjs`,`tms_yw_dingdan`.`zhongl` AS `zhongl`,`tms_yw_dingdan`.`tiji` AS `tiji`,`tms_yw_dingdan`.`shrdh` AS `shrdh`,`tms_yw_dingdan`.`shouhuoren` AS `shouhuoren`,`tms_yw_dingdan`.`hwshfs` AS `hwshfs`,`tms_yw_dingdan`.`shrsj` AS `shrsj`,`tms_yw_dingdan`.`daishouk` AS `daishouk`,`tms_yw_dingdan`.`hwyf` AS `hwyf`,((`tms_yw_dingdan`.`daishouk` + `tms_yw_dingdan`.`hwyf`) + `tms_yw_dingdan`.`hwxhf`) AS `hwzfy`,`tms_yw_dingdan`.`hwxhf` AS `hwxhf`,`tms_yw_dingdan`.`chehao` AS `chehao`,`tms_yw_dingdan`.`zhuangtai` AS `zhuangtai`,`tms_yw_dingdan`.`ywhdbz` AS `ywhdbz`,`tms_yw_dingdan`.`sdsj` AS `sdsj`,`tms_yw_dingdan`.`by1` AS `by1`,`tms_yw_dingdan`.`ywkhdh` AS `YWKHDH` from `tms_yw_dingdan` where (`tms_yw_dingdan`.`zhuangtai` <> '已删除');

-- View structure for wave_fuhe
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `wave_fuhe` AS select `wd`.`id` AS `id`,`wd`.`create_by` AS `create_by`,`wd`.`create_name` AS `create_name`,`wd`.`ku_wei_bian_ma` AS `ku_wei_bian_ma`,`wd`.`order_id` AS `order_id`,`wd`.`order_type` AS `order_type`,`wd`.`goods_id` AS `goods_id`,`mg`.`goods_name` AS `goods_name`,`wd`.`base_goodscount` AS `goods_qua`,`mg`.`baseunit` AS `shl_dan_wei`,`wd`.`cus_code` AS `cus_code`,`mc`.`cus_name` AS `cus_name`,`wd`.`goods_pro_data` AS `goods_pro_data`,`wd`.`down_sta` AS `down_sta` from ((`wm_to_down_goods` `wd` join `mv_goods` `mg`) join `mv_cus` `mc`) where ((`wd`.`cus_code` = `mc`.`cus_code`) and (`wd`.`goods_id` = `mg`.`goods_code`) and (`wd`.`order_type` = '99') and (`wd`.`down_sta` is null));

-- View structure for wave_fuhe_head
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `wave_fuhe_head` AS select `wave_fuhe`.`order_id` AS `order_id`,`wave_fuhe`.`cus_name` AS `cus_name`,`wave_fuhe`.`create_by` AS `create_by` from `wave_fuhe` group by `wave_fuhe`.`order_id`,`wave_fuhe`.`cus_name`,`wave_fuhe`.`create_by`;

-- View structure for wv_stock
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `wv_stock` AS select concat(`wg`.`ku_wei_bian_ma`,`wg`.`bin_id`,`wg`.`goods_id`,`wg`.`goods_pro_data`) AS `id`,`wg`.`create_date` AS `create_date`,`wg`.`create_name` AS `create_name`,`wg`.`create_by` AS `create_by`,`wg`.`kuctype` AS `kuctype`,cast(sum(`wg`.`base_goodscount`) as signed) AS `goods_qua`,`wg`.`goods_unit` AS `goods_unit`,cast(sum(`wg`.`base_goodscount`) as signed) AS `base_goodscount`,`wg`.`base_unit` AS `base_unit`,`wg`.`ku_wei_bian_ma` AS `ku_wei_bian_ma`,`wg`.`bin_id` AS `bin_id`,`wg`.`cus_code` AS `cus_code`,`wg`.`zhong_wen_qch` AS `zhong_wen_qch`,`wg`.`goods_id` AS `goods_id`,`wg`.`goods_code` AS `goods_code`,`wg`.`shp_ming_cheng` AS `shp_ming_cheng`,`wg`.`shl_dan_wei` AS `shl_dan_wei`,`wg`.`chl_shl` AS `chl_shl`,`wg`.`goods_pro_data` AS `goods_pro_data`,`wg`.`bzhi_qi` AS `bzhi_qi`,`wg`.`shp_gui_ge` AS `shp_gui_ge`,(`wg`.`goods_pro_data` + interval ifnull(`wg`.`bzhi_qi`,0) day) AS `dqr`,`mb`.`ku_wei_lei_xing` AS `ku_wei_lei_xing`,`mb`.`qu_huo_ci_xu` AS `qu_huo_ci_xu`,`mb`.`shang_jia_ci_xu` AS `shang_jia_ci_xu`,`mb`.`bin_store` AS `bin_store`,`wg`.`ti_ji_cm` AS `ti_ji_cm`,`mb`.`ti_ji_dan_wei` AS `ti_ji_dan_wei`,`mb`.`zhong_liang_dan_wei` AS `zhong_liang_dan_wei`,`mb`.`mian_ji_dan_wei` AS `mian_ji_dan_wei`,`mb`.`zui_da_ti_ji` AS `zui_da_ti_ji`,`mb`.`zui_da_mian_ji` AS `zui_da_mian_ji` from (`wv_stock_base` `wg` join `md_bin` `mb`) where (`wg`.`ku_wei_bian_ma` = `mb`.`ku_wei_bian_ma`) group by `wg`.`ku_wei_bian_ma`,`wg`.`bin_id`,`wg`.`cus_code`,`wg`.`goods_id`,`wg`.`goods_pro_data`,`wg`.`kuctype` having (sum(`wg`.`base_goodscount`) <> 0);

-- View structure for wv_stock_stt_ava
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `wv_stock_stt_ava` AS select `wg`.`ku_wei_bian_ma` AS `ku_wei_bian_ma`,`wg`.`bin_id` AS `bin_id`,`wg`.`cus_code` AS `cus_code`,`wg`.`zhong_wen_qch` AS `zhong_wen_qch`,`wg`.`goods_id` AS `goods_id`,`wg`.`goods_code` AS `goods_code`,`wg`.`shp_ming_cheng` AS `shp_ming_cheng`,`wg`.`shp_gui_ge` AS `shp_gui_ge`,`wg`.`chl_shl` AS `chl_shl`,`wg`.`goods_pro_data` AS `goods_pro_data`,`wg`.`bzhi_qi` AS `bzhi_qi`,`wg`.`dqr` AS `dqr`,`wg`.`ku_wei_lei_xing` AS `ku_wei_lei_xing`,`wg`.`qu_huo_ci_xu` AS `qu_huo_ci_xu`,`wg`.`shang_jia_ci_xu` AS `shang_jia_ci_xu`,`wg`.`bin_store` AS `bin_store`,`wg`.`base_goodscount` AS `base_goodscount`,sum(`wg`.`base_goodscount`) AS `goods_qua`,`wg`.`base_unit` AS `base_unit` from `wv_stock` `wg` group by `wg`.`ku_wei_bian_ma`,`wg`.`bin_id`,`wg`.`cus_code`,`wg`.`goods_id`,`wg`.`goods_pro_data`;

-- View structure for wave_to_down
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `wave_to_down` AS select `wo`.`id` AS `id`,`wo`.`create_by` AS `create_by`,`wo`.`create_name` AS `create_name`,`wo`.`cus_code` AS `cus_code`,`wo`.`cus_name` AS `cus_name`,`wo`.`wave_id` AS `wave_id`,`wo`.`goods_id` AS `goods_id`,`wo`.`goods_name` AS `goods_name`,`wo`.`im_cus_code` AS `im_cus_code`,`wo`.`bin_id` AS `bin_id`,`wo`.`tin_id` AS `tin_id`,`wo`.`pro_data` AS `pro_data`,sum(`wo`.`base_goodscount`) AS `base_goodscount`,(select `wvs`.`goods_qua` from `wv_stock_stt_ava` `wvs` where ((`wvs`.`ku_wei_bian_ma` = `wo`.`bin_id`) and (`wvs`.`bin_id` = `wo`.`tin_id`) and (`wvs`.`goods_id` = `wo`.`goods_id`) and (`wvs`.`goods_pro_data` = `wo`.`pro_data`) and (`wvs`.`cus_code` = `wo`.`cus_code`)) limit 1) AS `om_bei_zhu`,`wo`.`base_unit` AS `base_unit`,`wo`.`first_rq` AS `first_rq`,`wo`.`second_rq` AS `second_rq`,'' AS `by1`,'' AS `by2`,'' AS `by3`,'' AS `by4`,'' AS `by5`,`mg`.`shp_tiao_ma` AS `shp_tiao_ma` from (`wm_om_qm_i` `wo` left join `mv_goods` `mg` on((`wo`.`goods_id` = `mg`.`goods_code`))) where ((`wo`.`wave_id` is not null) and (`wo`.`bin_sta` = 'N')) group by `wo`.`cus_code`,`wo`.`cus_name`,`wo`.`wave_id`,`wo`.`goods_id`,`wo`.`goods_name`,`wo`.`bin_id`,`wo`.`tin_id`,`wo`.`pro_data`;

-- View structure for wave_to_down_head
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `wave_to_down_head` AS select `wave_to_down`.`wave_id` AS `wave_id`,`wave_to_down`.`cus_name` AS `cus_name` from `wave_to_down` group by `wave_to_down`.`wave_id`,`wave_to_down`.`cus_name`;

-- View structure for wave_to_fj
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `wave_to_fj` AS select `wo`.`id` AS `id`,`wo`.`create_by` AS `create_by`,`wo`.`create_name` AS `create_name`,`wo`.`cus_code` AS `cus_code`,`wo`.`cus_name` AS `cus_name`,`wo`.`om_notice_id` AS `om_notice_id`,`wo`.`iom_notice_item` AS `iom_notice_item`,`wo`.`goods_id` AS `goods_id`,`wo`.`goods_name` AS `goods_name`,`wo`.`bin_id` AS `bin_id`,`wo`.`tin_id` AS `tin_id`,`wo`.`pro_data` AS `pro_data`,sum(`wo`.`base_goodscount`) AS `base_goodscount`,`wo`.`base_unit` AS `base_unit`,`wo`.`wave_id` AS `wave_id`,`wo`.`first_rq` AS `first_rq`,`wo`.`second_rq` AS `second_rq`,'' AS `by1`,'' AS `by2`,'' AS `by3`,'' AS `by4`,'' AS `by5`,`mg`.`shp_tiao_ma` AS `shp_tiao_ma` from (`wm_om_qm_i` `wo` left join `mv_goods` `mg` on((`wo`.`goods_id` = `mg`.`goods_code`))) where ((`wo`.`wave_id` is not null) and (`wo`.`bin_sta` = 'H')) group by `wo`.`cus_code`,`wo`.`cus_name`,`wo`.`om_notice_id`,`wo`.`iom_notice_item`,`wo`.`goods_id`,`wo`.`goods_name`,`wo`.`bin_id`,`wo`.`tin_id`;

-- View structure for wave_to_fj_head
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `wave_to_fj_head` AS select `wave_to_fj`.`om_notice_id` AS `om_notice_id`,`wave_to_fj`.`cus_name` AS `cus_name`,`wave_to_fj`.`wave_id` AS `wave_id` from `wave_to_fj` group by `wave_to_fj`.`om_notice_id`,`wave_to_fj`.`cus_name`,`wave_to_fj`.`wave_id`;

-- View structure for wave_to_zcfh
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `wave_to_zcfh` AS select `wo`.`id` AS `id`,`wo`.`create_by` AS `create_by`,`wo`.`create_name` AS `create_name`,`wo`.`cus_code` AS `cus_code`,`wo`.`cus_name` AS `cus_name`,`wo`.`om_notice_id` AS `om_notice_id`,`wo`.`iom_notice_item` AS `iom_notice_item`,`wo`.`goods_id` AS `goods_id`,`wo`.`goods_name` AS `goods_name`,`wo`.`bin_id` AS `bin_id`,`wo`.`tin_id` AS `tin_id`,`wo`.`pro_data` AS `pro_data`,sum(`wo`.`base_goodscount`) AS `base_goodscount`,`wo`.`base_unit` AS `base_unit`,`wo`.`wave_id` AS `wave_id` from `wm_om_qm_i` `wo` where ((`wo`.`wave_id` is not null) and (`wo`.`bin_sta` = 'F')) group by `wo`.`cus_code`,`wo`.`cus_name`,`wo`.`om_notice_id`,`wo`.`iom_notice_item`,`wo`.`goods_id`,`wo`.`goods_name`,`wo`.`bin_id`,`wo`.`tin_id`;

-- View structure for wave_to_zcfh_head
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `wave_to_zcfh_head` AS select `wave_to_zcfh`.`om_notice_id` AS `om_notice_id`,`wave_to_zcfh`.`cus_name` AS `cus_name`,`wave_to_zcfh`.`wave_id` AS `wave_id` from `wave_to_zcfh` group by `wave_to_zcfh`.`om_notice_id`,`wave_to_zcfh`.`cus_name`,`wave_to_zcfh`.`wave_id`;

-- View structure for wv_avabin
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `wv_avabin` AS select `md`.`id` AS `id`,`md`.`create_name` AS `create_name`,`md`.`create_by` AS `create_by`,`md`.`create_date` AS `create_date`,`md`.`update_name` AS `update_name`,`md`.`update_by` AS `update_by`,`md`.`update_date` AS `update_date`,`md`.`sys_org_code` AS `sys_org_code`,`md`.`sys_company_code` AS `sys_company_code`,`md`.`ku_wei_ming_cheng` AS `ku_wei_ming_cheng`,`md`.`ku_wei_bian_ma` AS `binid`,`md`.`ku_wei_tiao_ma` AS `ku_wei_tiao_ma`,`md`.`ku_wei_lei_xing` AS `ku_wei_lei_xing`,`md`.`ku_wei_shu_xing` AS `ku_wei_shu_xing`,`md`.`shang_jia_ci_xu` AS `shang_jia_ci_xu`,`md`.`qu_huo_ci_xu` AS `qu_huo_ci_xu`,`md`.`suo_shu_ke_hu` AS `suo_shu_ke_hu`,`md`.`ti_ji_dan_wei` AS `ti_ji_dan_wei`,`md`.`zhong_liang_dan_wei` AS `zhong_liang_dan_wei`,`md`.`mian_ji_dan_wei` AS `mian_ji_dan_wei`,`md`.`zui_da_ti_ji` AS `zui_da_ti_ji`,`md`.`zui_da_zhong_liang` AS `zui_da_zhong_liang`,`md`.`zui_da_mian_ji` AS `zui_da_mian_ji`,`md`.`zui_da_tuo_pan` AS `zui_da_tuo_pan`,`md`.`chang` AS `chang`,`md`.`kuan` AS `kuan`,`md`.`gao` AS `gao`,`md`.`ting_yong` AS `ting_yong`,`md`.`ming_xi` AS `ming_xi`,`md`.`bin_store` AS `bin_store`,`md`.`CHP_SHU_XING` AS `CHP_SHU_XING`,`md`.`ming_xi1` AS `ming_xi1`,`md`.`ming_xi2` AS `ming_xi2`,`md`.`ming_xi3` AS `ming_xi3`,`md`.`LORA_bqid` AS `LORA_bqid` from `md_bin` `md` where ((`md`.`ting_yong` <> 'Y') and (`md`.`zui_da_tuo_pan` > (select count(0) from `wv_stock` `ws` where ((`ws`.`goods_qua` <> 0) and (`ws`.`ku_wei_bian_ma` = `md`.`ku_wei_bian_ma`))))) order by `md`.`shang_jia_ci_xu`;

-- View structure for wv_avabin_all
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `wv_avabin_all` AS select `md`.`id` AS `id`,`md`.`create_name` AS `create_name`,`md`.`create_by` AS `create_by`,`md`.`create_date` AS `create_date`,`md`.`update_name` AS `update_name`,`md`.`update_by` AS `update_by`,`md`.`update_date` AS `update_date`,`md`.`sys_org_code` AS `sys_org_code`,`md`.`sys_company_code` AS `sys_company_code`,`md`.`ku_wei_ming_cheng` AS `ku_wei_ming_cheng`,`md`.`ku_wei_bian_ma` AS `binid`,`md`.`ku_wei_tiao_ma` AS `ku_wei_tiao_ma`,`md`.`ku_wei_lei_xing` AS `ku_wei_lei_xing`,`md`.`ku_wei_shu_xing` AS `ku_wei_shu_xing`,`md`.`shang_jia_ci_xu` AS `shang_jia_ci_xu`,`md`.`qu_huo_ci_xu` AS `qu_huo_ci_xu`,`md`.`suo_shu_ke_hu` AS `suo_shu_ke_hu`,`md`.`ti_ji_dan_wei` AS `ti_ji_dan_wei`,`md`.`zhong_liang_dan_wei` AS `zhong_liang_dan_wei`,`md`.`mian_ji_dan_wei` AS `mian_ji_dan_wei`,`md`.`zui_da_ti_ji` AS `zui_da_ti_ji`,`md`.`zui_da_zhong_liang` AS `zui_da_zhong_liang`,`md`.`zui_da_mian_ji` AS `zui_da_mian_ji`,`md`.`zui_da_tuo_pan` AS `zui_da_tuo_pan`,`md`.`chang` AS `chang`,`md`.`kuan` AS `kuan`,`md`.`gao` AS `gao`,`md`.`ting_yong` AS `ting_yong`,`md`.`ming_xi` AS `ming_xi`,`md`.`bin_store` AS `bin_store`,`md`.`CHP_SHU_XING` AS `CHP_SHU_XING`,`md`.`ming_xi1` AS `ming_xi1`,`md`.`ming_xi2` AS `ming_xi2`,`md`.`ming_xi3` AS `ming_xi3`,`md`.`LORA_bqid` AS `LORA_bqid` from `md_bin` `md` where (`md`.`ting_yong` <> 'Y') order by `md`.`shang_jia_ci_xu`;

-- View structure for wv_bin
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `wv_bin` AS select `md`.`id` AS `id`,`md`.`bin_store` AS `bin_store`,`md`.`ku_wei_shu_xing` AS `ku_wei_shu_xing`,`md`.`CHP_SHU_XING` AS `chp_shu_xing`,`md`.`ku_wei_bian_ma` AS `binid`,`md`.`suo_shu_ke_hu` AS `suo_shu_ke_hu`,`md`.`zui_da_ti_ji` AS `zui_da_ti_ji`,`md`.`shang_jia_ci_xu` AS `shang_jia_ci_xu`,`md`.`chang` AS `chang`,`md`.`kuan` AS `kuan`,`md`.`gao` AS `gao`,`md`.`zui_da_tuo_pan` AS `zui_da_tuo_pan`,`md`.`ting_yong` AS `ting_yong`,`md`.`ku_wei_lei_xing` AS `ku_wei_lei_xing` from `md_bin` `md` where (`md`.`ting_yong` <> 'Y') order by `md`.`shang_jia_ci_xu`;

-- View structure for wv_bin_all_base
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `wv_bin_all_base` AS select `md`.`id` AS `id`,`md`.`xnode` AS `xnode`,`md`.`ynode` AS `ynode`,`md`.`znode` AS `znode`,`md`.`bin_store` AS `bin_store`,`md`.`ku_wei_shu_xing` AS `ku_wei_shu_xing`,`md`.`CHP_SHU_XING` AS `chp_shu_xing`,`md`.`ku_wei_bian_ma` AS `binid`,`md`.`suo_shu_ke_hu` AS `suo_shu_ke_hu`,`md`.`zui_da_ti_ji` AS `zui_da_ti_ji`,`md`.`shang_jia_ci_xu` AS `shang_jia_ci_xu`,`md`.`chang` AS `chang`,`md`.`kuan` AS `kuan`,`md`.`gao` AS `gao`,`md`.`zui_da_tuo_pan` AS `zui_da_tuo_pan`,`md`.`ting_yong` AS `ting_yong`,`md`.`ku_wei_lei_xing` AS `ku_wei_lei_xing`,(select count(0) from `wv_stock` `ws` where ((`ws`.`goods_qua` <> 0) and (`ws`.`ku_wei_bian_ma` = `md`.`ku_wei_bian_ma`))) AS `tincount`,(select group_concat('货主：',`ws`.`zhong_wen_qch`,',  商品：',`ws`.`shp_ming_cheng`,',  生产日期：',`ws`.`goods_pro_data`,',  数量：',`ws`.`base_goodscount`,',  单位：',`ws`.`shl_dan_wei` separator '|') AS `des` from `wv_stock` `ws` where ((`ws`.`goods_qua` <> 0) and (`ws`.`ku_wei_bian_ma` = `md`.`ku_wei_bian_ma`))) AS `des` from `md_bin` `md` order by `md`.`ming_xi3`,`md`.`ku_wei_bian_ma`;

-- View structure for wv_bin_all
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `wv_bin_all` AS select `wv_bin_all_base`.`id` AS `id`,`wv_bin_all_base`.`xnode` AS `xnode`,`wv_bin_all_base`.`ynode` AS `ynode`,`wv_bin_all_base`.`znode` AS `znode`,if((`wv_bin_all_base`.`tincount` > 1),'red','green') AS `colour`,`wv_bin_all_base`.`bin_store` AS `bin_store`,`wv_bin_all_base`.`ku_wei_shu_xing` AS `ku_wei_shu_xing`,`wv_bin_all_base`.`chp_shu_xing` AS `chp_shu_xing`,`wv_bin_all_base`.`binid` AS `binid`,`wv_bin_all_base`.`suo_shu_ke_hu` AS `suo_shu_ke_hu`,`wv_bin_all_base`.`zui_da_ti_ji` AS `zui_da_ti_ji`,`wv_bin_all_base`.`shang_jia_ci_xu` AS `shang_jia_ci_xu`,`wv_bin_all_base`.`chang` AS `chang`,`wv_bin_all_base`.`kuan` AS `kuan`,`wv_bin_all_base`.`gao` AS `gao`,`wv_bin_all_base`.`zui_da_tuo_pan` AS `zui_da_tuo_pan`,`wv_bin_all_base`.`ting_yong` AS `ting_yong`,`wv_bin_all_base`.`ku_wei_lei_xing` AS `ku_wei_lei_xing`,`wv_bin_all_base`.`tincount` AS `tincount`,`wv_bin_all_base`.`des` AS `des` from `wv_bin_all_base`;

-- View structure for wv_day_cost_sum
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `wv_day_cost_sum` AS select concat(`wc`.`cost_data`,`wc`.`cus_code`,`wc`.`cost_code`) AS `id`,`wc`.`cost_data` AS `cost_data`,`wc`.`cus_code` AS `cus_code`,`wc`.`cus_name` AS `cus_name`,`wc`.`cost_code` AS `cost_code`,`wc`.`cost_name` AS `cost_name`,`wc`.`cost_js` AS `cost_js`,round(sum(`wc`.`day_cost_yj`),2) AS `yuanj`,round(sum(`wc`.`day_cost_bhs`),2) AS `bhsj`,round(sum(`wc`.`day_cost_se`),2) AS `shuie`,round(sum(`wc`.`cost_sl`),2) AS `cost_sl`,round(sum(`wc`.`day_cost_hsj`),2) AS `hansj`,`wc`.`cost_unit` AS `cost_unit` from `wm_day_cost` `wc` group by `wc`.`cus_code`,`wc`.`cus_name`,`wc`.`cost_code`,`wc`.`cost_name`,`wc`.`cost_data`,`wc`.`cost_js`,`wc`.`cost_unit`;

-- View structure for wv_gi
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `wv_gi` AS select `wd`.`id` AS `id`,`wd`.`create_date` AS `create_date`,`wd`.`ku_wei_bian_ma` AS `ku_wei_bian_ma`,`wd`.`order_id` AS `order_id`,`wd`.`goods_id` AS `goods_id`,`mg`.`goods_name` AS `goods_name`,`wd`.`base_goodscount` AS `goods_qua`,`mg`.`baseunit` AS `shl_dan_wei`,`mg`.`zhx_unit` AS `zhx_unit`,`mg`.`chl_shl` AS `chl_shl`,`wd`.`cus_code` AS `cus_code`,`mc`.`cus_name` AS `cus_name`,`wd`.`goods_pro_data` AS `goods_pro_data`,`wd`.`down_sta` AS `down_sta`,`wd`.`im_cus_code` AS `im_cus_code` from ((`wm_to_down_goods` `wd` join `mv_goods` `mg`) join `mv_cus` `mc`) where ((`wd`.`cus_code` = `mc`.`cus_code`) and (`wd`.`goods_id` = `mg`.`goods_code`));

-- View structure for wv_gi_head
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `wv_gi_head` AS select `wv_gi`.`order_id` AS `order_id`,`wv_gi`.`cus_name` AS `cus_name` from `wv_gi` where (`wv_gi`.`down_sta` is null) group by `wv_gi`.`order_id`,`wv_gi`.`cus_name` order by `wv_gi`.`order_id` desc;

-- View structure for wv_gi_notice
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `wv_gi_notice` AS select `wg`.`create_date` AS `create_date`,`wg`.`create_name` AS `create_name`,`wg`.`create_by` AS `create_by`,`wg`.`update_date` AS `update_date`,`wg`.`id` AS `id`,`wg`.`im_cus_code` AS `im_cus_code`,`wg`.`om_notice_id` AS `om_notice_id`,`wg`.`iom_notice_item` AS `iom_notice_item`,`wg`.`bin_id` AS `bin_id`,`wg`.`tin_id` AS `tin_id`,`wg`.`cus_code` AS `cus_code`,`mc`.`zhong_wen_qch` AS `zhong_wen_qch`,`wg`.`goods_id` AS `goods_id`,`wg`.`qm_ok_quat` AS `gi_count`,`mg`.`goods_name` AS `shp_ming_cheng`,`wg`.`pro_data` AS `goods_pro_data`,`mg`.`bzhi_qi` AS `bzhi_qi`,`mg`.`zhx_unit` AS `zhx_unit`,`mg`.`chl_shl` AS `chl_shl`,`wg`.`goods_unit` AS `shl_dan_wei`,`wg`.`goods_unit` AS `goods_unit`,`wg`.`base_unit` AS `base_unit`,`wg`.`base_goodscount` AS `base_goodscount`,`wg`.`assign_to` AS `assign_To`,`mg`.`shp_gui_ge` AS `shp_gui_ge`,(select `wm_om_notice_h`.`om_beizhu` from `wm_om_notice_h` where (`wm_om_notice_h`.`om_notice_id` = `wg`.`om_notice_id`)) AS `om_bei_zhu` from ((`wm_om_qm_i` `wg` join `md_cus` `mc`) join `mv_goods` `mg`) where ((`wg`.`cus_code` = `mc`.`ke_hu_bian_ma`) and (`wg`.`goods_id` = `mg`.`goods_code`) and (`wg`.`bin_sta` = 'N')) order by `wg`.`bin_id`;

-- View structure for wv_gi_notice_head
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `wv_gi_notice_head` AS select `wv_gi_notice`.`om_notice_id` AS `om_notice_id`,`wv_gi_notice`.`zhong_wen_qch` AS `zhong_wen_qch` from `wv_gi_notice` group by `wv_gi_notice`.`om_notice_id`,`wv_gi_notice`.`zhong_wen_qch` order by `wv_gi_notice`.`om_bei_zhu` desc;

-- View structure for wv_gr
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `wv_gr` AS select `i`.`id` AS `id`,`i`.`im_notice_id` AS `im_notice_id`,'托盘上' AS `kucunsta`,`i`.`bin_id` AS `bin_id`,`i`.`tin_id` AS `tin_id`,`i`.`cus_code` AS `cus_code`,`mc`.`zhong_wen_qch` AS `zhong_wen_qch`,`i`.`goods_id` AS `goods_id`,`mg`.`goods_name` AS `shp_ming_cheng`,`mg`.`shl_dan_wei` AS `shl_dan_wei`,`i`.`qm_ok_quat` AS `qm_ok_quat`,`i`.`pro_data` AS `pro_data`,`i`.`create_date` AS `create_date`,`i`.`item_text` AS `item_text`,`mg`.`bzhi_qi` AS `bzhi_qi` from ((`md_cus` `mc` join `mv_goods` `mg`) join `wm_in_qm_i` `i`) where ((`i`.`cus_code` = `mc`.`ke_hu_bian_ma`) and (`i`.`goods_id` = `mg`.`goods_code`) and (`i`.`bin_sta` = 'N'));

-- View structure for wv_in_out_h
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `wv_in_out_h` AS select `wm_im_notice_h`.`notice_id` AS `notice_id`,`wm_im_notice_h`.`im_cus_code` AS `im_cus_code`,`wm_im_notice_h`.`im_car_dri` AS `delv_member`,`wm_im_notice_h`.`im_car_no` AS `delv_mobile`,`wm_im_notice_h`.`im_beizhu` AS `delv_addr`,`wm_im_notice_h`.`sup_code` AS `ocus_code`,`wm_im_notice_h`.`sup_name` AS `ocus_name` from `wm_im_notice_h` union all select `wm_om_notice_h`.`om_notice_id` AS `notice_id`,`wm_om_notice_h`.`IM_CUS_CODE` AS `im_cus_code`,`wm_om_notice_h`.`delv_member` AS `delv_member`,`wm_om_notice_h`.`delv_mobile` AS `delv_mobile`,`wm_om_notice_h`.`delv_addr` AS `delv_addr`,`wm_om_notice_h`.`ocus_code` AS `ocus_code`,`wm_om_notice_h`.`ocus_name` AS `ocus_name` from `wm_om_notice_h`;

-- View structure for wv_last_move
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `wv_last_move` AS select `wt`.`id` AS `id`,`wt`.`create_date` AS `create_date`,`wt`.`ku_wei_bian_ma` AS `ku_wei_bian_ma`,`wt`.`bin_id` AS `bin_id`,`wt`.`goods_id` AS `goods_id`,`wt`.`goods_pro_data` AS `goods_pro_data` from `wm_to_up_goods` `wt` where ((to_days(now()) - to_days(`wt`.`create_date`)) < 7) union all select `wt`.`id` AS `id`,`wt`.`create_date` AS `create_date`,`wt`.`ku_wei_bian_ma` AS `ku_wei_bian_ma`,`wt`.`bin_id_from` AS `bin_id`,`wt`.`goods_id` AS `goods_id`,`wt`.`goods_pro_data` AS `goods_pro_data` from `wm_to_down_goods` `wt` where ((to_days(now()) - to_days(`wt`.`create_date`)) < 7);

-- View structure for wv_last_picking
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `wv_last_picking` AS select `wt`.`id` AS `id`,`wt`.`create_date` AS `create_date`,`wt`.`bin_id` AS `ku_wei_bian_ma`,`wt`.`tin_id` AS `bin_id`,`wt`.`goods_id` AS `goods_id`,`wt`.`pro_data` AS `goods_pro_data` from `wm_om_qm_i` `wt` order by `wt`.`create_date` desc;

-- View structure for wv_last_picking_stock
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `wv_last_picking_stock` AS select `wg`.`ku_wei_bian_ma` AS `ku_wei_bian_ma`,`wg`.`bin_id` AS `bin_id`,`wg`.`cus_code` AS `cus_code`,`wg`.`zhong_wen_qch` AS `zhong_wen_qch`,`wg`.`goods_id` AS `goods_id`,`wg`.`goods_code` AS `goods_code`,`wg`.`shp_ming_cheng` AS `shp_ming_cheng`,`wg`.`shp_gui_ge` AS `shp_gui_ge`,`wg`.`chl_shl` AS `chl_shl`,`wg`.`goods_pro_data` AS `goods_pro_data`,`wg`.`bzhi_qi` AS `bzhi_qi`,`wg`.`dqr` AS `dqr`,`wg`.`ku_wei_lei_xing` AS `ku_wei_lei_xing`,`wg`.`qu_huo_ci_xu` AS `qu_huo_ci_xu`,`wg`.`shang_jia_ci_xu` AS `shang_jia_ci_xu`,`wg`.`bin_store` AS `bin_store`,`wg`.`base_goodscount` AS `base_goodscount`,(select `wv_last_picking`.`create_date` from `wv_last_picking` where ((`wv_last_picking`.`ku_wei_bian_ma` = `wg`.`ku_wei_bian_ma`) and (`wv_last_picking`.`goods_id` = `wg`.`goods_id`)) limit 1) AS `LAST_date`,sum(`wg`.`base_goodscount`) AS `keyongkucun`,sum((case when (`wg`.`kuctype` = '待下架') then `wg`.`base_goodscount` end)) AS `daixiaj`,`wg`.`base_unit` AS `base_unit` from `wv_stock` `wg` group by `wg`.`ku_wei_bian_ma`,`wg`.`bin_id`,`wg`.`cus_code`,`wg`.`goods_id`,`wg`.`goods_pro_data`;

-- View structure for wv_no_use_bin
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `wv_no_use_bin` AS select `md`.`id` AS `id`,`md`.`bin_store` AS `bin_store`,`md`.`ku_wei_shu_xing` AS `ku_wei_shu_xing`,`md`.`CHP_SHU_XING` AS `chp_shu_xing`,`md`.`ku_wei_bian_ma` AS `binid`,`md`.`suo_shu_ke_hu` AS `suo_shu_ke_hu`,`md`.`zui_da_ti_ji` AS `zui_da_ti_ji`,`md`.`shang_jia_ci_xu` AS `shang_jia_ci_xu`,`md`.`chang` AS `chang`,`md`.`kuan` AS `kuan`,`md`.`gao` AS `gao`,`md`.`zui_da_tuo_pan` AS `zui_da_tuo_pan`,`md`.`ting_yong` AS `ting_yong`,`md`.`ku_wei_lei_xing` AS `ku_wei_lei_xing` from `md_bin` `md` where ((`md`.`ting_yong` <> 'Y') and (1 > (select count(0) from `wv_stock` `ws` where ((`ws`.`goods_qua` <> 0) and (`ws`.`ku_wei_bian_ma` = `md`.`ku_wei_bian_ma`))))) order by `md`.`shang_jia_ci_xu`;

-- View structure for wv_notice
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `wv_notice` AS select `i`.`id` AS `id`,`h`.`notice_id` AS `notice_id`,`h`.`cus_code` AS `cus_code`,`h`.`im_cus_code` AS `im_cus_code`,`mc`.`zhong_wen_qch` AS `zhong_wen_qch`,`h`.`im_sta` AS `im_sta`,`i`.`goods_code` AS `goods_code`,`mg`.`goods_name` AS `shp_ming_cheng`,`mg`.`shp_tiao_ma` AS `shp_tiao_ma`,`mg`.`cf_wen_ceng` AS `cf_wen_ceng`,`mg`.`mp_dan_ceng` AS `mp_dan_ceng`,`mg`.`mp_ceng_gao` AS `mp_ceng_gao`,`mg`.`ti_ji_cm` AS `ti_ji_cm`,`i`.`goods_count` AS `goods_count`,ifnull(`i`.`goods_qm_count`,0) AS `goods_qm_count`,(`i`.`goods_count` - ifnull(`i`.`goods_qm_count`,0)) AS `gr_count`,`mg`.`shl_dan_wei` AS `shl_dan_wei`,`i`.`goods_fvol` AS `goods_fvol`,`i`.`goods_weight` AS `goods_weight`,(curdate() - interval (`mg`.`bzhi_qi` - `mg`.`zhl_kgm`) day) AS `lastgrdate`,(select `wm_in_qm_i`.`pro_data` from `wm_in_qm_i` where ((`wm_in_qm_i`.`goods_id` = `i`.`goods_code`) and (`wm_in_qm_i`.`im_notice_id` <> `i`.`im_notice_id`)) order by `wm_in_qm_i`.`create_date` desc limit 1) AS `preprodate`,(select `wm_in_qm_i`.`rec_deg` from `wm_in_qm_i` where (`wm_in_qm_i`.`im_notice_id` = `i`.`im_notice_id`) order by `wm_in_qm_i`.`create_date` desc limit 1) AS `rec_deg` from (((`wm_im_notice_h` `h` join `wm_im_notice_i` `i`) join `md_cus` `mc`) join `mv_goods` `mg`) where ((`h`.`notice_id` = `i`.`im_notice_id`) and (`h`.`cus_code` = `mc`.`ke_hu_bian_ma`) and (`i`.`bin_pre` = 'N') and (`i`.`goods_code` = `mg`.`goods_code`) and (`h`.`order_type_code` <> '04')) order by `h`.`notice_id` desc;

-- View structure for wv_notice_head
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `wv_notice_head` AS select `wv_notice`.`notice_id` AS `notice_id`,`wv_notice`.`zhong_wen_qch` AS `zhong_wen_qch` from `wv_notice` group by `wv_notice`.`notice_id`,`wv_notice`.`zhong_wen_qch`;

-- View structure for wv_stock_base_bak
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `wv_stock_base_bak` AS select `wg`.`create_date` AS `create_date`,`wg`.`create_name` AS `create_name`,`wg`.`create_by` AS `create_by`,`wg`.`id` AS `id`,'库存' AS `kuctype`,`wg`.`ku_wei_bian_ma` AS `ku_wei_bian_ma`,trim(`wg`.`bin_id`) AS `bin_id`,`wg`.`cus_code` AS `cus_code`,`wg`.`cus_code` AS `zhong_wen_qch`,`mg`.`goods_id` AS `goods_code`,`wg`.`goods_id` AS `goods_id`,sum(`wg`.`goods_qua`) AS `goods_qua`,`mg`.`goods_name` AS `shp_ming_cheng`,`wg`.`goods_pro_data` AS `goods_pro_data`,`mg`.`bzhi_qi` AS `bzhi_qi`,`mg`.`zhl_kgm` AS `yushoutianshu`,`wg`.`goods_unit` AS `goods_unit`,`wg`.`base_unit` AS `base_unit`,sum(`wg`.`base_goodscount`) AS `base_goodscount`,`mg`.`shl_dan_wei` AS `shl_dan_wei`,concat(`mg`.`mp_ceng_gao`,'*',`mg`.`mp_dan_ceng`) AS `hiti`,`mg`.`shp_bian_makh` AS `shp_bian_makh`,`mg`.`chl_shl` AS `chl_shl`,`wg`.`order_id` AS `order_id`,`mg`.`zhl_kg` AS `zhl_kg` from (`wm_to_up_goods` `wg` left join `mv_goods` `mg` on((`wg`.`goods_id` = `mg`.`goods_code`))) group by `wg`.`ku_wei_bian_ma`,`wg`.`bin_id`,`wg`.`cus_code`,`wg`.`goods_id`,`wg`.`goods_pro_data` union all select `wg`.`create_date` AS `create_date`,`wg`.`create_name` AS `create_name`,`wg`.`create_by` AS `create_by`,`wg`.`id` AS `id`,'库存' AS `kuctype`,`wg`.`ku_wei_bian_ma` AS `ku_wei_bian_ma`,trim(`wg`.`bin_id_from`) AS `bin_id`,`wg`.`cus_code` AS `cus_code`,`wg`.`cus_code` AS `zhong_wen_qch`,`mg`.`goods_id` AS `goods_code`,`wg`.`goods_id` AS `goods_id`,sum((0 - `wg`.`goods_quaok`)) AS `goods_qua`,`mg`.`goods_name` AS `shp_ming_cheng`,`wg`.`goods_pro_data` AS `goods_pro_data`,`mg`.`bzhi_qi` AS `bzhi_qi`,`mg`.`zhl_kgm` AS `yushoutianshu`,`wg`.`goods_unit` AS `goods_unit`,`wg`.`base_unit` AS `base_unit`,sum((0 - `wg`.`base_goodscount`)) AS `base_goodscount`,`mg`.`shl_dan_wei` AS `shl_dan_wei`,`mg`.`chl_shl` AS `chl_shl`,concat(`mg`.`mp_ceng_gao`,'*',`mg`.`mp_dan_ceng`) AS `hiti`,`mg`.`shp_bian_makh` AS `shp_bian_makh`,`wg`.`order_id` AS `order_id`,`mg`.`zhl_kg` AS `zhl_kg` from (`wm_to_down_goods` `wg` left join `mv_goods` `mg` on((`wg`.`goods_id` = `mg`.`goods_code`))) group by `wg`.`ku_wei_bian_ma`,`wg`.`bin_id_from`,`wg`.`cus_code`,`wg`.`goods_id`,`wg`.`goods_pro_data` union all select `wg`.`create_date` AS `create_date`,`wg`.`create_name` AS `create_name`,`wg`.`create_by` AS `create_by`,`wg`.`id` AS `id`,'待下架' AS `kuctype`,`wg`.`bin_id` AS `ku_wei_bian_ma`,trim(`wg`.`tin_id`) AS `bin_id`,`wg`.`cus_code` AS `cus_code`,`wg`.`cus_code` AS `zhong_wen_qch`,`mg`.`goods_id` AS `goods_code`,`wg`.`goods_id` AS `goods_id`,sum((0 - `wg`.`qm_ok_quat`)) AS `goods_qua`,`mg`.`goods_name` AS `shp_ming_cheng`,`wg`.`pro_data` AS `goods_pro_data`,`mg`.`bzhi_qi` AS `bzhi_qi`,`mg`.`zhl_kgm` AS `yushoutianshu`,`wg`.`goods_unit` AS `goods_unit`,`wg`.`base_unit` AS `base_unit`,sum((0 - `wg`.`base_goodscount`)) AS `base_goodscount`,`mg`.`shl_dan_wei` AS `shl_dan_wei`,`mg`.`chl_shl` AS `chl_shl`,concat(`mg`.`mp_ceng_gao`,'*',`mg`.`mp_dan_ceng`) AS `hiti`,`mg`.`shp_bian_makh` AS `shp_bian_makh`,`wg`.`om_notice_id` AS `order_id`,`mg`.`zhl_kg` AS `zhl_kg` from (`wm_om_qm_i` `wg` left join `mv_goods` `mg` on((`wg`.`goods_id` = `mg`.`goods_code`))) where ((`wg`.`bin_sta` = 'N') or (`wg`.`bin_sta` = 'I')) group by `wg`.`bin_id`,`wg`.`tin_id`,`wg`.`cus_code`,`wg`.`goods_id`,`wg`.`pro_data`;

-- View structure for wv_stock_base_stock
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `wv_stock_base_stock` AS select `wg`.`create_date` AS `create_date`,`wg`.`create_name` AS `create_name`,`wg`.`create_by` AS `create_by`,`wg`.`id` AS `id`,'库存' AS `kuctype`,`wg`.`ku_wei_bian_ma` AS `ku_wei_bian_ma`,trim(`wg`.`bin_id`) AS `bin_id`,`wg`.`cus_code` AS `cus_code`,`wg`.`cus_code` AS `zhong_wen_qch`,`wg`.`goods_id` AS `goods_id`,`wg`.`goods_qua` AS `goods_qua`,`wg`.`order_id` AS `order_id`,`wg`.`goods_pro_data` AS `goods_pro_data`,`wg`.`goods_unit` AS `goods_unit`,`wg`.`base_unit` AS `base_unit`,`wg`.`base_goodscount` AS `base_goodscount` from `wm_to_up_goods` `wg` union all select `wg`.`create_date` AS `create_date`,`wg`.`create_name` AS `create_name`,`wg`.`create_by` AS `create_by`,`wg`.`id` AS `id`,'库存' AS `kuctype`,`wg`.`ku_wei_bian_ma` AS `ku_wei_bian_ma`,trim(`wg`.`bin_id_from`) AS `bin_id`,`wg`.`cus_code` AS `cus_code`,`wg`.`cus_code` AS `zhong_wen_qch`,`wg`.`goods_id` AS `goods_id`,(0 - `wg`.`goods_quaok`) AS `goods_qua`,`wg`.`order_id` AS `order_id`,`wg`.`goods_pro_data` AS `goods_pro_data`,`wg`.`goods_unit` AS `goods_unit`,`wg`.`base_unit` AS `base_unit`,(0 - `wg`.`base_goodscount`) AS `base_goodscount` from `wm_to_down_goods` `wg` union all select `wg`.`create_date` AS `create_date`,`wg`.`create_name` AS `create_name`,`wg`.`create_by` AS `create_by`,`wg`.`id` AS `id`,'待下架' AS `kuctype`,`wg`.`bin_id` AS `ku_wei_bian_ma`,trim(`wg`.`tin_id`) AS `bin_id`,`wg`.`cus_code` AS `cus_code`,`wg`.`cus_code` AS `zhong_wen_qch`,`wg`.`goods_id` AS `goods_id`,(0 - `wg`.`qm_ok_quat`) AS `goods_qua`,`wg`.`om_notice_id` AS `order_id`,`wg`.`pro_data` AS `goods_pro_data`,`wg`.`goods_unit` AS `goods_unit`,`wg`.`base_unit` AS `base_unit`,(0 - `wg`.`base_goodscount`) AS `base_goodscount` from `wm_om_qm_i` `wg` where ((`wg`.`bin_sta` = 'N') or (`wg`.`bin_sta` = 'I'));

-- View structure for wv_stock_last_stt
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `wv_stock_last_stt` AS select `ws`.`create_date` AS `create_date`,`ws`.`create_name` AS `create_name`,`ws`.`create_by` AS `create_by`,concat(`ws`.`ku_wei_bian_ma`,`ws`.`bin_id`,`ws`.`goods_id`,`ws`.`goods_pro_data`) AS `id`,`ws`.`ku_wei_bian_ma` AS `ku_wei_bian_ma`,`ws`.`bin_id` AS `bin_id`,`ws`.`cus_code` AS `cus_code`,`ws`.`zhong_wen_qch` AS `zhong_wen_qch`,`ws`.`goods_code` AS `goods_code`,`ws`.`goods_id` AS `goods_id`,cast(sum(`ws`.`base_goodscount`) as signed) AS `goods_qua`,`ws`.`shp_ming_cheng` AS `shp_ming_cheng`,`ws`.`goods_pro_data` AS `goods_pro_data`,`ws`.`bzhi_qi` AS `bzhi_qi`,`ws`.`yushoutianshu` AS `yushoutianshu`,`ws`.`base_unit` AS `goods_unit`,(select max(`wvp`.`create_date`) from `wv_last_picking` `wvp` where ((`wvp`.`ku_wei_bian_ma` = `ws`.`ku_wei_bian_ma`) and (`wvp`.`goods_id` = `ws`.`goods_id`))) AS `last_move` from `wv_stock_base` `ws` where ((`ws`.`kuctype` = '库存') or (`ws`.`kuctype` = ' 待下架')) group by `ws`.`ku_wei_bian_ma`,`ws`.`bin_id`,`ws`.`cus_code`,`ws`.`zhong_wen_qch`,`ws`.`goods_code`,`ws`.`goods_pro_data`,`ws`.`bzhi_qi` having (sum(`ws`.`base_goodscount`) > 0) order by `ws`.`ku_wei_bian_ma`;

-- View structure for wv_stock_stt
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `wv_stock_stt` AS select `ws`.`create_date` AS `create_date`,`ws`.`create_name` AS `create_name`,`ws`.`create_by` AS `create_by`,concat(`ws`.`ku_wei_bian_ma`,`ws`.`bin_id`,`ws`.`goods_id`,`ws`.`goods_pro_data`) AS `id`,`ws`.`kuctype` AS `kuctype`,`ws`.`ku_wei_bian_ma` AS `ku_wei_bian_ma`,`ws`.`bin_id` AS `bin_id`,`ws`.`cus_code` AS `cus_code`,`ws`.`zhong_wen_qch` AS `zhong_wen_qch`,`ws`.`goods_code` AS `goods_code`,`ws`.`goods_id` AS `goods_id`,cast(sum(`ws`.`base_goodscount`) as signed) AS `goods_qua`,`ws`.`shp_ming_cheng` AS `shp_ming_cheng`,`ws`.`goods_pro_data` AS `goods_pro_data`,`ws`.`bzhi_qi` AS `bzhi_qi`,`ws`.`yushoutianshu` AS `yushoutianshu`,`ws`.`base_unit` AS `goods_unit`,(select `wm_stt_in_goods`.`stt_sta` from `wm_stt_in_goods` where ((`wm_stt_in_goods`.`bin_id` = `ws`.`ku_wei_bian_ma`) and (`wm_stt_in_goods`.`tin_id` = convert(`ws`.`bin_id` using utf8)) and (`wm_stt_in_goods`.`goods_id` = `ws`.`goods_id`) and (`wm_stt_in_goods`.`goods_pro_data` = `ws`.`goods_pro_data`)) limit 1) AS `stt_sta`,(select `wm_to_move_goods`.`move_sta` from `wm_to_move_goods` where ((`wm_to_move_goods`.`bin_from` = `ws`.`ku_wei_bian_ma`) and (`wm_to_move_goods`.`tin_from` = convert(`ws`.`bin_id` using utf8)) and (`wm_to_move_goods`.`goods_id` = `ws`.`goods_id`) and (`wm_to_move_goods`.`goods_pro_data` = `ws`.`goods_pro_data`)) order by `wm_to_move_goods`.`create_date` desc limit 1) AS `move_sta`,(select `wv_last_move`.`create_date` from `wv_last_move` where ((`wv_last_move`.`ku_wei_bian_ma` = `ws`.`ku_wei_bian_ma`) and (`wv_last_move`.`bin_id` = convert(`ws`.`bin_id` using utf8)) and (`wv_last_move`.`goods_id` = `ws`.`goods_id`) and (`wv_last_move`.`goods_pro_data` = `ws`.`goods_pro_data`)) order by `wv_last_move`.`create_date` desc limit 1) AS `last_move` from `wv_stock_base` `ws` where ((`ws`.`kuctype` = '库存') or (`ws`.`kuctype` = ' 待下架')) group by `ws`.`ku_wei_bian_ma`,`ws`.`bin_id`,`ws`.`cus_code`,`ws`.`zhong_wen_qch`,`ws`.`goods_code`,`ws`.`goods_pro_data`,`ws`.`bzhi_qi`,`ws`.`kuctype` having (sum(`ws`.`base_goodscount`) > 0) order by `ws`.`ku_wei_bian_ma`;

-- View structure for wv_stock_stt_bin
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `wv_stock_stt_bin` AS select `ws`.`create_date` AS `create_date`,`ws`.`create_name` AS `create_name`,`ws`.`create_by` AS `create_by`,concat(`ws`.`ku_wei_bian_ma`,`ws`.`goods_id`,`ws`.`goods_pro_data`) AS `id`,`ws`.`kuctype` AS `kuctype`,`ws`.`ku_wei_bian_ma` AS `ku_wei_bian_ma`,`ws`.`bin_id` AS `bin_id`,`ws`.`cus_code` AS `cus_code`,`ws`.`zhong_wen_qch` AS `zhong_wen_qch`,`ws`.`goods_id` AS `goods_id`,cast(sum(`ws`.`goods_qua`) as signed) AS `goods_qua`,`ws`.`shp_ming_cheng` AS `shp_ming_cheng`,`ws`.`goods_pro_data` AS `goods_pro_data`,`ws`.`bzhi_qi` AS `bzhi_qi`,`ws`.`goods_unit` AS `goods_unit`,(select `wm_stt_in_goods`.`stt_sta` from `wm_stt_in_goods` where (`wm_stt_in_goods`.`bin_id` = `ws`.`ku_wei_bian_ma`) order by `wm_stt_in_goods`.`create_date` desc limit 1) AS `stt_sta`,(select `wm_to_move_goods`.`move_sta` from `wm_to_move_goods` where (`wm_to_move_goods`.`bin_from` = `ws`.`ku_wei_bian_ma`) order by `wm_to_move_goods`.`create_date` desc limit 1) AS `move_sta`,(select `wv_last_move`.`create_date` from `wv_last_move` where ((`wv_last_move`.`ku_wei_bian_ma` = `ws`.`ku_wei_bian_ma`) and (`wv_last_move`.`goods_id` = `ws`.`goods_id`)) order by `wv_last_move`.`create_date` desc limit 1) AS `last_move` from `wv_stock_base` `ws` where (`ws`.`kuctype` = '库存') group by `ws`.`ku_wei_bian_ma`,`ws`.`cus_code`,`ws`.`zhong_wen_qch`,`ws`.`goods_id`,`ws`.`goods_pro_data`,`ws`.`bzhi_qi`,`ws`.`kuctype` order by `ws`.`ku_wei_bian_ma`;

-- View structure for wv_stt_head
CREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `wv_stt_head` AS select `wm_stt_in_goods`.`create_date` AS `id` from `wm_stt_in_goods` where (`wm_stt_in_goods`.`stt_sta` = '计划中') group by `wm_stt_in_goods`.`create_date`;
